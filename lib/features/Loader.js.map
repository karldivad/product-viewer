{"version":3,"file":"Loader.js","sourceRoot":"","sources":["../../src/features/Loader.ts"],"names":[],"mappings":";;;;;;AAuBA,OAAO,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAC7C,OAAO,EAAgB,WAAW,EAAE,MAAM,iBAAiB,CAAC;AAO5D,MAAM,CAAC,MAAM,WAAW,GAAG,CAC1B,iBAAoB,EACe,EAAE;IACrC,MAAM,wBAAyB,SAAQ,iBAAiB;QAAxD;;YAGC,cAAS,GAAG,KAAK,CAAC;QA0CnB,CAAC;QAvCA,OAAO,CAAC,iBAAmC;;YAC1C,MAAA,KAAK,CAAC,OAAO,qDAAG,iBAAiB,CAAC,CAAC;YAEnC,IAAI,iBAAiB,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;gBACtC,IAAI,CAAC,YAAY,EAAE,CAAC;aACpB;QACF,CAAC;QAED,YAAY;YACX,sDAAsD;YACtD,IAAI,IAAI,CAAC,YAAY,EAAE;gBACtB,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,YAAY,EAAE;oBACtC,KAAK,CAAC,OAAO,EAAE,CAAC;iBAChB;gBACD,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;aACvB;YAED,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBACnB,OAAO,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;gBACxC,OAAO;aACP;YAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAEtB,WAAW,CAAC,UAAU,CACrB,EAAE,EACF,IAAI,CAAC,QAAQ,EACb,EAAE,EACF,IAAI,CAAC,KAAK,EACV,CAAC,MAAM,EAAE,EAAE;gBACV,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;gBAC3B,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;gBACzB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACxB,CAAC,EACD,IAAI,EACJ,IAAI,EACJ,MAAM,CACN,CAAC;QACH,CAAC;KACD;IA5CmE;QAAlE,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;8DAAkB;IA6CrF,OAAO,wBAA4D,CAAC;AACrE,CAAC,CAAC","sourcesContent":["/* @license\n * Copyright 2022 Lowe's Companies, Inc. All Rights Reserved.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nimport ProductViewerElementBase from \"../product-viewer-base\";\nimport { Constructor } from \"../tools/Utils\";\nimport { property } from \"lit/decorators.js\";\nimport { AbstractMesh, SceneLoader } from \"@babylonjs/core\";\n\nexport declare interface LoaderInterface {\n\tmodelUrl: string;\n\tisLoading: boolean;\n}\n\nexport const LoaderMixin = <T extends Constructor<ProductViewerElementBase>>(\n\tBaseViewerElement: T,\n): Constructor<LoaderInterface> & T => {\n\tclass LoaderModelViewerElement extends BaseViewerElement {\n\t\t@property({ type: String, attribute: \"model-url\", reflect: true }) modelUrl: string;\n\n\t\tisLoading = false;\n\t\tloadedModels: AbstractMesh[];\n\n\t\tupdated(changedProperties: Map<string, any>): void {\n\t\t\tsuper.updated?.(changedProperties);\n\n\t\t\tif (changedProperties.has(\"modelUrl\")) {\n\t\t\t\tthis.updateLoader();\n\t\t\t}\n\t\t}\n\n\t\tupdateLoader(): void {\n\t\t\t// Remove all existing models before loading a new one\n\t\t\tif (this.loadedModels) {\n\t\t\t\tfor (const model of this.loadedModels) {\n\t\t\t\t\tmodel.dispose();\n\t\t\t\t}\n\t\t\t\tthis.loadedModels = [];\n\t\t\t}\n\n\t\t\tif (!this.modelUrl) {\n\t\t\t\tconsole.warn(\"No `model-url` provided\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\n\t\t\tSceneLoader.ImportMesh(\n\t\t\t\t\"\",\n\t\t\t\tthis.modelUrl,\n\t\t\t\t\"\",\n\t\t\t\tthis.scene,\n\t\t\t\t(meshes) => {\n\t\t\t\t\tthis.loadedModels = meshes;\n\t\t\t\t\tthis.modelLoaded(meshes);\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t},\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\t\".glb\",\n\t\t\t);\n\t\t}\n\t}\n\treturn LoaderModelViewerElement as Constructor<LoaderInterface> & T;\n};\n"]}